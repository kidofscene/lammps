import numpy as np
import matplotlib.pyplot as plt

# Заданные точки
x = np.array([0, 0.000499, 0.000999, 0.001499, 0.001999, 0.002499, 0.002999, 0.003499, 0.003999, 0.004499, 0.004999, 0.005499, 0.005999, 0.006499, 0.006999, 0.007499, 0.007999, 0.008499, 0.008999, 0.009499, 0.009999, 0.010499, 0.010999, 0.011499, 0.011999, 0.012499, 0.012999, 0.013499, 0.013999, 0.014499, 0.014999, 0.015499, 0.015999, 0.016499, 0.016999, 0.017499, 0.017999, 0.018499, 0.018999, 0.019499, 0.019999, 0.020499, 0.020999, 0.021499, 0.021999, 0.022499, 0.022999, 0.023499, 0.023999, 0.024499, 0.024999, 0.025499, 0.025999, 0.026499, 0.026999, 0.027499, 0.027999, 0.028499, 0.028999, 0.029499, 0.029999, 0.030499, 0.030999, 0.031499, 0.031999, 0.032499, 0.032999, 0.033499, 0.033999, 0.034499, 0.034999, 0.035499, 0.035999, 0.036499, 0.036999, 0.037499, 0.037999, 0.038499, 0.038999, 0.039499, 0.039999, 0.040499, 0.040999, 0.041499, 0.041999, 0.042499, 0.042999, 0.043499, 0.043999, 0.044499, 0.044999, 0.045499, 0.045999, 0.046499, 0.046999, 0.047499, 0.047999, 0.048499, 0.048999, 0.049499, 0.049999, 0.050499, 0.050999, 0.051499, 0.051999, 0.052499, 0.052999, 0.053499, 0.053999, 0.054499, 0.054999, 0.055499, 0.055999, 0.056499, 0.056999, 0.057499, 0.057999, 0.058499, 0.058999, 0.059499, 0.059999, 0.060499, 0.060999, 0.061499, 0.061999, 0.062499, 0.062999, 0.063499, 0.063999, 0.064499, 0.064999, 0.065499, 0.065999, 0.066499, 0.066999, 0.067499, 0.067999, 0.068499, 0.068999, 0.069499, 0.069999, 0.070499, 0.070999, 0.071499, 0.071999, 0.072499, 0.072999, 0.073499, 0.073999, 0.074499, 0.074999, 0.075499, 0.075999, 0.076499, 0.076999, 0.077499, 0.077999, 0.078499, 0.078999, 0.079499, 0.079999, 0.080499, 0.080999, 0.081499, 0.081999, 0.082499, 0.082999, 0.083499, 0.083999, 0.084499, 0.084999, 0.085499, 0.085999, 0.086499, 0.086999, 0.087499, 0.087999, 0.088499, 0.088999, 0.089499, 0.089999, 0.090499, 0.090999, 0.091499, 0.091999, 0.092499, 0.092999, 0.093499, 0.093999, 0.094499, 0.094999, 0.095499, 0.095999, 0.096499, 0.096999, 0.097499, 0.097999, 0.098499, 0.098999, 0.099499, 0.099999, 0.1]
)
y = np.array([-9.2798976e-15, -9.2798936e-15, -9.2798816e-15, -9.27986144e-15, -9.27983328e-15, -9.279797120000001e-15, -9.279752960000001e-15, -9.2797008e-15, -9.2796408e-15, -9.2795728e-15, -9.2794968e-15, -9.27941296e-15, -9.27932128e-15, -9.27922176e-15, -9.279114240000001e-15, -9.278999040000001e-15, -9.278876000000001e-15, -9.278745120000001e-15, -9.278606400000001e-15, -9.27846e-15, -9.27830576e-15, -9.278143839999999e-15, -9.27797424e-15, -9.277796960000002e-15, -9.277611999999999e-15, -9.27741936e-15, -9.27721904e-15, -9.277011200000001e-15, -9.27679568e-15, -9.276572480000001e-15, -9.27634176e-15, -9.27610352e-15, -9.27585776e-15, -9.27560448e-15, -9.275343680000001e-15, -9.27507536e-15, -9.27479968e-15, -9.27451648e-15, -9.274225760000001e-15, -9.273927680000001e-15, -9.27362224e-15, -9.27330928e-15, -9.272989120000001e-15, -9.2726616e-15, -9.27232656e-15, -9.27198432e-15, -9.27163488e-15, -9.27127808e-15, -9.27091392e-15, -9.270542560000001e-15, -9.270164000000002e-15, -9.269778240000002e-15, -9.26938528e-15, -9.268984960000001e-15, -9.26857776e-15, -9.268163199999999e-15, -9.2677416e-15, -9.2673128e-15, -9.26687696e-15, -9.266434080000001e-15, -9.265984000000002e-15, -9.26552688e-15, -9.26506288e-15, -9.26459168e-15, -9.264113599999999e-15, -9.263628480000001e-15, -9.263136480000002e-15, -9.26263744e-15, -9.262131520000001e-15, -9.26161856e-15, -9.26109888e-15, -9.260572160000001e-15, -9.26003856e-15, -9.25949824e-15, -9.259232000000001e-15, -9.258396960000001e-15, -9.257836e-15, -9.25726848e-15, -9.25669392e-15, -9.2561128e-15, -9.255524960000001e-15, -9.254930239999999e-15, -9.2543288e-15, -9.253720799999999e-15, -9.253106080000001e-15, -9.25248464e-15, -9.25185664e-15, -9.251221920000001e-15, -9.25058064e-15, -9.249932800000001e-15, -9.249278399999999e-15, -9.24861728e-15, -9.24794976e-15, -9.24727568e-15, -9.24659504e-15, -9.245908000000002e-15, -9.2452144e-15, -9.244514240000002e-15, -9.243807680000001e-15, -9.24309472e-15, -9.24237536e-15, -9.2416496e-15, -9.240917279999999e-15, -9.24017872e-15, -9.23943392e-15, -9.238682560000001e-15, -9.237924960000002e-15, -9.23716112e-15, -9.23639088e-15, -9.2356144e-15, -9.234831520000002e-15, -9.234042560000002e-15, -9.233247360000001e-15, -9.23244592e-15, -9.23163824e-15, -9.23082432e-15, -9.230004320000001e-15, -9.22917808e-15, -9.22834576e-15, -9.22750736e-15, -9.22666288e-15, -9.22581216e-15, -9.22495536e-15, -9.224092639999999e-15, -9.223223680000001e-15, -9.2223488e-15, -9.221468e-15, -9.22058096e-15, -9.21968816e-15, -9.21878928e-15, -9.21788448e-15, -9.2169736e-15, -9.21605696e-15, -9.2151344e-15, -9.21420576e-15, -9.213271360000002e-15, -9.212331200000001e-15, -9.211385120000001e-15, -9.210433120000002e-15, -9.209475359999999e-15, -9.20851184e-15, -9.2075424e-15, -9.2065672e-15, -9.2055864e-15, -9.204599680000001e-15, -9.20360736e-15, -9.20260928e-15, -9.201605440000001e-15, -9.200596000000001e-15, -9.199580800000001e-15, -9.19856e-15, -9.19753344e-15, -9.19650144e-15, -9.19546368e-15, -9.19442048e-15, -9.19337152e-15, -9.19231712e-15, -9.19125712e-15, -9.19019152e-15, -9.18912048e-15, -9.18804384e-15, -9.18696176e-15, -9.18587424e-15, -9.18478128e-15, -9.18368288e-15, -9.182578880000001e-15, -9.181469599999999e-15, -9.180354880000001e-15, -9.17923472e-15, -9.17810928e-15, -9.1769784e-15, -9.175842240000001e-15, -9.174700640000001e-15, -9.173553760000001e-15, -9.1724016e-15, -9.17124416e-15, -9.17008144e-15, -9.16891344e-15, -9.16774016e-15, -9.16656176e-15, -9.165378080000001e-15, -9.16418912e-15, -9.16299504e-15, -9.16179584e-15, -9.160591360000001e-15, -9.159381920000001e-15, -9.1581672e-15, -9.156947360000001e-15, -9.1557224e-15, -9.154492480000001e-15, -9.153257280000001e-15, -9.15201712e-15, -9.150772e-15, -9.14952176e-15, -9.14826656e-15, -9.147006239999999e-15, -9.14574112e-15, -9.14447088e-15, -9.14319568e-15, -9.14191552e-15, -9.140630560000001e-15, -9.140627840000002e-15]
)
# Проводим полиномиальную аппроксимацию
degree = 4

p = np.polyfit(x, y, degree)
poly = np.poly1d(p)
x_new = np.linspace(min(x), max(x), 100)
y_new = poly(x_new)


# Строим графики
plt.scatter(x, y, color='blue', label='Точки')
plt.plot(x_new, y_new, color='red', label='Аппроксимация')
plt.xlabel('x')
plt.ylabel('y')
plt.legend()
plt.show()
print(poly)